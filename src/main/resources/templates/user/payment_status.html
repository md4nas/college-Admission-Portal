<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{base::Layout(~{::section})}">
<head>
    <meta charset="UTF-8">
    <title>Payment Status</title>
</head>
<body>

<section>
    <div class="container-fluid">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card bg-primary text-white">
                    <div class="card-body text-center py-4">
                        <i class='bx bx-wallet-alt' style="font-size: 3rem;"></i>
                        <h2 class="mt-3 mb-2">Fee Payment Status</h2>
                        <p class="mb-0">Track your fee payments and outstanding dues</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Payment Status for Accepted Students -->
        <div th:if="${application != null and application.status == 'ACCEPTED'}">
            <!-- Fee Structure -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h5><i class='bx bx-money me-2'></i>Fee Structure</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card border-primary">
                                        <div class="card-body">
                                            <h6 class="card-title text-primary">Semester 1 Fees</h6>
                                            <div class="row">
                                                <div class="col-8">Tuition Fee</div>
                                                <div class="col-4 text-end">₹45,000</div>
                                            </div>
                                            <div class="row">
                                                <div class="col-8">Development Fee</div>
                                                <div class="col-4 text-end">₹10,000</div>
                                            </div>
                                            <div class="row">
                                                <div class="col-8">Lab Fee</div>
                                                <div class="col-4 text-end">₹5,000</div>
                                            </div>
                                            <div class="row">
                                                <div class="col-8">Library Fee</div>
                                                <div class="col-4 text-end">₹2,000</div>
                                            </div>
                                            <hr>
                                            <div class="row fw-bold">
                                                <div class="col-8">Total</div>
                                                <div class="col-4 text-end">₹62,000</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card border-info">
                                        <div class="card-body">
                                            <h6 class="card-title text-info">Payment Status</h6>
                                            <div class="text-center mb-3">
                                                <i class='bx bx-time-five text-warning' style="font-size: 3rem;"></i>
                                                <h5 class="mt-2 text-warning">Payment Pending</h5>
                                                <p class="text-muted">Please complete your fee payment to secure admission</p>
                                            </div>
                                            <div class="d-grid">
                                                <button class="btn btn-primary btn-lg" onclick="initiatePayment()">
                                                    <i class='bx bx-credit-card me-2'></i>Pay Now - ₹62,000
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Payment Instructions -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header bg-info text-white">
                            <h5><i class='bx bx-info-circle me-2'></i>Payment Instructions</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="text-primary">Online Payment Options</h6>
                                    <ul class="list-unstyled">
                                        <li class="mb-2"><i class='bx bx-check text-success me-2'></i>Credit/Debit Cards</li>
                                        <li class="mb-2"><i class='bx bx-check text-success me-2'></i>Net Banking</li>
                                        <li class="mb-2"><i class='bx bx-check text-success me-2'></i>UPI Payments</li>
                                        <li class="mb-2"><i class='bx bx-check text-success me-2'></i>Digital Wallets</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-primary">Important Notes</h6>
                                    <ul class="list-unstyled">
                                        <li class="mb-2"><i class='bx bx-info-circle text-info me-2'></i>Payment deadline: 30 days from admission</li>
                                        <li class="mb-2"><i class='bx bx-info-circle text-info me-2'></i>Late payment attracts penalty</li>
                                        <li class="mb-2"><i class='bx bx-info-circle text-info me-2'></i>Keep payment receipt safe</li>
                                        <li class="mb-2"><i class='bx bx-info-circle text-info me-2'></i>Contact office for payment issues</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Payment History -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header bg-secondary text-white">
                            <h5><i class='bx bx-history me-2'></i>Payment History</h5>
                        </div>
                        <div class="card-body">
                            <div class="text-center py-4">
                                <i class='bx bx-receipt text-muted' style="font-size: 3rem;"></i>
                                <h6 class="mt-3 text-muted">No Payment History</h6>
                                <p class="text-muted mb-0">Your payment transactions will appear here once completed</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- For Allocated Students -->
        <div th:if="${application != null and application.status == 'ALLOCATED'}">
            <div class="row">
                <div class="col-12">
                    <div class="alert alert-warning">
                        <h5 class="alert-heading"><i class='bx bx-time me-2'></i>Seat Acceptance Required</h5>
                        <p class="mb-2">Please accept your allocated seat to proceed with fee payment and complete your admission process.</p>
                        <hr>
                        <div class="text-center">
                            <a href="/user/application/status" class="btn btn-warning">
                                <i class='bx bx-check me-2'></i>Accept Seat Now
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- For Non-Eligible Students -->
        <div th:if="${application == null or (application.status != 'ACCEPTED' and application.status != 'ALLOCATED')}">
            <div class="row">
                <div class="col-12">
                    <div class="text-center py-5">
                        <i class='bx bx-wallet text-muted' style="font-size: 5rem;"></i>
                        <h3 class="mt-4 text-muted">Payment Not Available</h3>
                        <p class="text-muted mb-4" th:if="${application == null}">Submit your college application to access fee payment options.</p>
                        <p class="text-muted mb-4" th:if="${application != null and application.status == 'SUBMITTED'}">Your application is under review. Payment options will be available after seat allocation.</p>
                        <p class="text-muted mb-4" th:if="${application != null and application.status == 'REJECTED'}">Your application was not approved. Please contact administration for further assistance.</p>
                        
                        <a th:if="${application == null}" href="/user/application" class="btn btn-primary btn-lg">
                            <i class='bx bx-plus me-2'></i>Submit Application
                        </a>
                        <a th:if="${application != null}" href="/user/application/status" class="btn btn-info btn-lg">
                            <i class='bx bx-file-blank me-2'></i>View Application Status
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="row mt-4">
            <div class="col-12 text-center">
                <a href="/user/" class="btn btn-secondary">
                    <i class='bx bx-arrow-back'></i> Back to Dashboard
                </a>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="modal fade" id="paymentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title"><i class='bx bx-credit-card me-2'></i>Payment Gateway</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center">
                    <i class='bx bx-credit-card text-primary' style="font-size: 4rem;"></i>
                    <h5 class="mt-3">Payment Integration</h5>
                    <p class="text-muted">This is a demo payment interface. In production, this would integrate with payment gateways like Razorpay, PayU, or Paytm.</p>
                    <div class="alert alert-info">
                        <strong>Amount to Pay:</strong> ₹62,000<br>
                        <strong>Student:</strong> <span th:text="${user.fullName}"></span><br>
                        <strong>Course:</strong> <span th:text="${application?.course}"></span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" onclick="simulatePayment()">
                        <i class='bx bx-check me-2'></i>Proceed to Pay
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function initiatePayment() {
            const paymentModal = new bootstrap.Modal(document.getElementById('paymentModal'));
            paymentModal.show();
        }

        function simulatePayment() {
            alert('Payment simulation completed! In production, this would process the actual payment.');
            const paymentModal = bootstrap.Modal.getInstance(document.getElementById('paymentModal'));
            paymentModal.hide();
        }
    </script>
</section>

</body>
</html>